<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR</title>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.5/dist/mindar-image.prod.js"></script>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
</head>
<body>
  
  <!--Botones-->

  <div id="ar-ui" style="display: none; position: fixed; top:20px; left:50%; transform:translateX(-50%); z-index:10; ">
    <button onclick="showVideo()">Video</button>
    <button onclick="showModel()">Model</button>
    <button onclick="showText()">Information</button>
    <button onclick="showQuestion()">Question</button>
  </div>

<div id="video-container" style="display:none; position:fixed; top:80px; left:50%; transform:translateX(-50%); z-index:20;">
    <video id="ar-video" width="320" controls>
      <source id="video-source" src="" type="video/mp4">
      Tu navegador no soporta video.
    </video>
  </div>

  <div id="question-container" style="display:none; position:fixed; top:150px; left:50%; transform:translateX(-50%); z-index:30; background:white; color:black; padding:20px; border-radius:15px;">
    <div id="question-text"></div>
    <div id="question-options"></div>
    <div id="question-feedback"></div>
  </div>

 
  <a-scene
    mindar-image="imageTargetSrc: targets.mind"
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false">

    <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

    <!-- contenedor donde se inserta dinamicamente -->
    <a-entity id="targets-container"></a-entity>
  </a-scene>

  <script>
  // número de imágenes en targets.mind
    const totalTargets = 78; 
    const container = document.getElementById("targets-container");
    const arUI = document.getElementById("ar-ui");
    let currentEntity = null;
    let currentTargetIndex = null;
    const videoMap = [
      { range: [0, 5], src: "videos/Argentina.mp4" }
    ];
    const entities = [];

    for (let i = 0; i < totalTargets; i++) {
      const entity = document.createElement("a-entity");
      entity.setAttribute("mindar-image-target", `targetIndex: ${i}`);
  
      if (i >= 0 && i <= 5) {
         //ARG Esfera
        let modelAR = document.createElement("a-gltf-model");
        modelAR.setAttribute("src", "modelos/Argentina/empanada.glb");
        modelAR.setAttribute("position", "0 0.2 0");
        modelAR.setAttribute("scale", "0.01 0.01 0.01");
        modelAR.setAttribute("rotation", "0 0 0");
        modelAR.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textAR = document.createElement("a-text");
        textAR.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textAR.setAttribute("value", "Argentina has appeared in the World Cup 18 times and won three titles (1978, 1986, 2022). Famous for legends like Diego Maradona and Lionel Messi, the team is known for flair, technical skill, and attacking football. Argentina consistently reaches advanced stages, including semifinals and finals. Its national team, “La Albiceleste,” is a source of national pride and global recognition.");
        textAR.setAttribute("align", "center");
        textAR.setAttribute("scale", "0.2 0.2 0.2");
        textAR.setAttribute("position", "0 -0.4 0");
        textAR.setAttribute("visible", "false");

       entity.appendChild(modelAR);
       entity.appendChild(textAR);
       entity.modelAR = modelAR;
       entity.textAR = textAR;

      } 
      else if (i >= 6 && i <= 11) {
        //AUS Cubo
        let modelAUS = document.createElement("a-gltf-model");
        modelAUS.setAttribute("src", "modelos/Australia/lamington.glb");
        modelAUS.setAttribute("position", "0 0.3 0");
        modelAUS.setAttribute("scale", "1 1 1");
        modelAUS.setAttribute("rotation", "0 0 0");
        modelAUS.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textAUS = document.createElement("a-text");
        textAUS.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textAUS.setAttribute("value", "Australia has qualified for the World Cup 6 times, debuting in 1974 and consistently appearing since 2006. Their best performance was reaching the Round of 16 in 2006. Known as the “Socceroos,” the team combines physical strength with tactical discipline. Australia has transitioned from the OFC to the AFC, increasing competition and exposure on the international stage");
        textAUS.setAttribute("align", "center");
        textAUS.setAttribute("scale", "0.2 0.2 0.2");
        textAUS.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelAUS);
       entity.appendChild(textAUS);
       container.appendChild(entity);
      }
      else if (i >= 12 && i <= 17) {
        //BRA Cilindro
       let modelBRA = document.createElement("a-gltf-model");
        modelBRA.setAttribute("src", "modelos/Brasil/world_cup_trophy.glb");
        modelBRA.setAttribute("position", "0 0.4 0");
        modelBRA.setAttribute("scale", ".001 .001 .001");
        modelBRA.setAttribute("rotation", "0 0 0");
        modelBRA.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textBRA = document.createElement("a-text");
        textBRA.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textBRA.setAttribute("value", "Brazil is the country with the most titles in World Cup history, having won five championships (1958, 1962, 1970, 1994, and 2002). Its national team is known for its attacking style, technical skill, and legendary players like Pelé, Romário, and Ronaldo. Brazil has participated in every edition of the tournament, the only country with this distinction. The “Seleção” is a national symbol of pride and football passion throughout the country.");
        textBRA.setAttribute("align", "center");
        textBRA.setAttribute("scale", "0.2 0.2 0.2");
        textBRA.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelBRA);
       entity.appendChild(textBRA);
       container.appendChild(entity);
      }
      else if (i >= 18 && i <= 23) {
         //CAN Esfera
        let modelCAN = document.createElement("a-gltf-model");
        modelCAN.setAttribute("src", "modelos/Canada/canadian_leaf.glb");
        modelCAN.setAttribute("position", "0 0.7 0");
        modelCAN.setAttribute("scale", ".01 .01 .01");
        modelCAN.setAttribute("rotation", "0 0 0");
        modelCAN.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textCAN = document.createElement("a-text");
        textCAN.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textCAN.setAttribute("value", "Canada has qualified for the World Cup twice, in 1986 and 2022. The 1986 appearance ended in the group stage, but the 2022 team showed growth and competitiveness. Soccer is still developing in Canada, but recent performances reflect the rising talent in Major League Soccer and youth programs. The national team is called the “Canadian Mens National Team” or CMNT.");
        textCAN.setAttribute("align", "center");
        textCAN.setAttribute("scale", "0.2 0.2 0.2");
        textCAN.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelCAN);
       entity.appendChild(textCAN);
       container.appendChild(entity);
      } 
      else if (i >= 24 && i <= 29) {
        //COR Cubo
        let modelCOR = document.createElement("a-gltf-model");
        modelCOR.setAttribute("src", "modelos/Corea del sur/south_korea.glb");
        modelCOR.setAttribute("position", "0 0.7 0");
        modelCOR.setAttribute("scale", ".5 .5 .5");
        modelCOR.setAttribute("rotation", "0 0 0");
        modelCOR.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textCOR = document.createElement("a-text");
        textCOR.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textCOR.setAttribute("value", "South Korea has qualified for the World Cup 11 times, debuting in 1954. Their most notable performance was in 2002, reaching the semifinals as co-hosts. The team, “Taeguk Warriors,” is known for speed, discipline, and stamina. South Korea is the most successful Asian team in World Cup history, regularly advancing from the group stage.");
        textCOR.setAttribute("align", "center");
        textCOR.setAttribute("scale", "0.2 0.2 0.2");
        textCOR.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelCOR);
       entity.appendChild(textCOR);
       container.appendChild(entity);
      }
      else if (i >= 30 && i <= 35) {
        //ECU Cilindro
        let modelECU = document.createElement("a-gltf-model");
        modelECU.setAttribute("src", "modelos/Ecuador/ecuador_anim.glb");
        modelECU.setAttribute("position", "0 0.6 0");
        modelECU.setAttribute("scale", ".3 .3 .3");
        modelECU.setAttribute("rotation", "0 0 0");
        modelECU.setAttribute("animation-mixer", "clip: *; loop: repeat");
        modelECU.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textECU = document.createElement("a-text");
        textECU.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textECU.setAttribute("value", "Ecuador has qualified for the World Cup four times: 2002, 2006, 2014, and 2022. Their best performance was in 2006, reaching the Round of 16. Ecuador team is known for itsd strong attacking players and physical style, often challenging South American rivals. The team, called “La Tricolor,” reflects the growing football culture in the country.");
        textECU.setAttribute("align", "center");
        textECU.setAttribute("scale", "0.2 0.2 0.2");
        textECU.setAttribute("position", "0 -0.4 0");
        //textECU.setAttribute("color", "black");


       entity.appendChild(modelECU);
       entity.appendChild(textECU);
       container.appendChild(entity);
      }
      else if (i >= 36 && i <= 41) {
         //EU Esfera
        let modelEU = document.createElement("a-gltf-model");
        modelEU.setAttribute("src", "modelos/Estados unidos/scene.gltf");
        modelEU.setAttribute("position", "0 0.6 0");
        modelEU.setAttribute("scale", "0.1 0.1 0.1");
        modelEU.setAttribute("rotation", "0 0 0");
        modelEU.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textEU = document.createElement("a-text");
        textEU.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textEU.setAttribute("value", "Hamburger: The hamburger became an icon of American food due to its convenience and popularity in the fast-food era. It represents modern, fast-paced urban life and the “American way of life.” Moreover, it is widely exported and associated with informal celebrations such as barbecues and picnics. Its versatility to include different ingredients reflects the cultural diversity of the country");
        textEU.setAttribute("align", "center");
        textEU.setAttribute("scale", "0.2 0.2 0.2");
        textEU.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelEU);
       entity.appendChild(textEU);
       container.appendChild(entity);

      } 
      else if (i >= 42 && i <= 47) {
        //JPN Cubo
        let modelJPN = document.createElement("a-gltf-model");
        modelJPN.setAttribute("src", "modelos/Japon/japan_flag.glb");
        modelJPN.setAttribute("position", "0 0.6 0");
        modelJPN.setAttribute("scale", "0.1 0.1 0.1");
        modelJPN.setAttribute("rotation", "0 0 0");
        modelJPN.setAttribute("animation-mixer", "clip: *; loop: repeat");
        modelJPN.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textJPN = document.createElement("a-text");
        textJPN.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textJPN.setAttribute("value", "Japan has participated in every World Cup since 1998, totaling 7 appearances. The team regularly reaches the Round of 16, showing consistency in Asia. Japan is known for its disciplined and technical style, emphasizing teamwork and speed. Its success has made the Samurai Blue a respected team in both Asia and global competitions.");
        textJPN.setAttribute("align", "center");
        textJPN.setAttribute("scale", "0.2 0.2 0.2");
        textJPN.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelJPN);
       entity.appendChild(textJPN);
       container.appendChild(entity);
      }
      else if (i >= 48 && i <= 53) {
        //JRD Cilindro
        let modelJRD = document.createElement("a-gltf-model");
        modelJRD.setAttribute("src", "modelos/Jordania/falafel.glb");
        modelJRD.setAttribute("position", "0 0.3 0");
        modelJRD.setAttribute("scale", "0.1 0.1 0.1");
        modelJRD.setAttribute("rotation", "0 0 0");
        modelJRD.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textJRD = document.createElement("a-text");
        textJRD.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textJRD.setAttribute("value", "Falafel: Deep-fried balls made from chickpeas or fava beans, seasoned with herbs and spices. Popular as street food, falafel reflects Levantine culinary traditions and Jordan’s Middle Eastern heritage. It is a symbol of affordability, nutrition, and cultural identity, often eaten with pita and tahini sauce.");
        textJRD.setAttribute("align", "center");
        textJRD.setAttribute("scale", "0.2 0.2 0.2");
        textJRD.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelJRD);
       entity.appendChild(textJRD);
       container.appendChild(entity);
      }
      else if (i >= 54 && i <= 59) {
         //MX Esfera
        let modelMX = document.createElement("a-gltf-model");
        modelMX.setAttribute("src", "modelos/Mexico/taco.glb");
        modelMX.setAttribute("position", "0 0.5 0");
        modelMX.setAttribute("scale", ".03 .03 .03");
        modelMX.setAttribute("rotation", "0 0 0");
        modelMX.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textMX = document.createElement("a-text");
        textMX.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textMX.setAttribute("value", "Tacos: Tacos are a cornerstone of Mexican cuisine, consisting of small tortillas filled with a variety of ingredients, such as meat, beans, cheese, or vegetables. They reflect the country’s culinary diversity and adaptability, as different regions have their own unique taco styles and flavors. Tacos are commonly eaten as street food, at family gatherings, and during festivals, symbolizing the informal, communal, and vibrant nature of Mexican food culture. Their simplicity, portability, and variety make them an enduring national culinary icon");
        textMX.setAttribute("align", "center");
        textMX.setAttribute("scale", "0.2 0.2 0.2");
        textMX.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelMX);
       entity.appendChild(textMX);
       container.appendChild(entity);
      } 
      else if (i >= 60 && i <= 65) {
        //NZL Cubo
        let modelNZL = document.createElement("a-gltf-model");
        modelNZL.setAttribute("src", "modelos/Nueva zelanda/pavlova.glb");
        modelNZL.setAttribute("position", "0 0.5 0");
        modelNZL.setAttribute("scale", "1 1 1");
        modelNZL.setAttribute("rotation", "0 0 0");
        modelNZL.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textNZL = document.createElement("a-text");
        textNZL.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textNZL.setAttribute("value", "Pavlova: A dessert made of crisp meringue outside and soft inside, topped with whipped cream and fresh fruits. Pavlova is celebrated as a national dessert in New Zealand, often served during holidays and special occasions. It reflects the country’s creativity in baking and the use of fresh, local ingredients. The dish embodies festive spirit and culinary pride.");
        textNZL.setAttribute("align", "center");
        textNZL.setAttribute("scale", "0.2 0.2 0.2");
        textNZL.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelNZL);
       entity.appendChild(textNZL);
       container.appendChild(entity);
      }
      else if (i >= 66 && i <= 71) {
        //RII Cilindro
        let modelRII = document.createElement("a-gltf-model");
        modelRII.setAttribute("src", "modelos/RII/iran_lion_and_sun_emblem.glb");
        modelRII.setAttribute("position", "0 0.5 0");
        modelRII.setAttribute("scale", ".05 .05 .05");
        modelRII.setAttribute("rotation", "0 0 0");
        modelRII.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textRII = document.createElement("a-text");
        textRII.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textRII.setAttribute("value", "Iran has qualified for the World Cup 6 times, debuting in 1978. The team often competes strongly in the group stage but has yet to advance past the Round of 16. Known as “Team Melli,” Iran is one of Asia most consistent national teams. Their disciplined, tactical play style is respected globally.");
        textRII.setAttribute("align", "center");
        textRII.setAttribute("scale", "0.2 0.2 0.2");
        textRII.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelRII);
       entity.appendChild(textRII);
       container.appendChild(entity);
      }
      else if (i >= 72 && i <= 77) {
         //UZB Esfera
        let modelUZB = document.createElement("a-gltf-model");
        modelUZB.setAttribute("src", "modelos/Uzbekistan/waving_uzbekistan_flag.glb");
        modelUZB.setAttribute("position", "0 0.3 0");
        modelUZB.setAttribute("scale", ".1 .1 .1");
        modelUZB.setAttribute("rotation", "0 0 0");
        modelUZB.setAttribute("animation-mixer", "clip: *; loop: repeat");
        modelUZB.setAttribute("animation", "property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear");

        let textUZB = document.createElement("a-text");
        textUZB.setAttribute("font", "https://cdn.aframe.io/fonts/mozillavr.fnt");
        textUZB.setAttribute("value", "Uzbekistan has never qualified for the FIFA World Cup. They are a strong team in Asia, often competing in AFC competitions like the Asian Cup. Despite not reaching the World Cup, Uzbekistan team, nicknamed the “White Wolves,” is recognized for technical skill and growing football development. The country continues to invest in youth and professional leagues to compete internationally.");
        textUZB.setAttribute("align", "center");
        textUZB.setAttribute("scale", "0.2 0.2 0.2");
        textUZB.setAttribute("position", "0 -0.4 0");

       entity.appendChild(modelUZB);
       entity.appendChild(textUZB);
       container.appendChild(entity);
      } 
      container.appendChild(entity);
      entities.push(entity);

      // Eventos para mostrar/ocultar UI global y guardar el target actual
      entity.addEventListener("targetFound", () => {
        arUI.style.display = "block";
        currentEntity = entity;
        currentTargetIndex = i;
        hideModel();
        closeVideo();
      });
      entity.addEventListener("targetLost", () => {
        arUI.style.display = "none";
        hideModel();
        closeVideo();
        hideText();
        hideQuestion();
        currentEntity = null;
        currentTargetIndex = null;
      });
    }

    //Funciones para mostrar y ocultar modelo
    function showModel() {
      if (currentEntity && currentEntity.modelAR) {
        currentEntity.modelAR.setAttribute("visible", "true");
      }
      hideText();
      closeVideo();
      hideQuestion();
    }

    function hideModel() {
      if (currentEntity && currentEntity.modelAR) {
        currentEntity.modelAR.setAttribute("visible", "false");
      }
    }

    //Funciones para mostrar y ocultar video
    function showVideo() {
      hideModel();
      // Busca el video correspondiente al target actual
      let videoSrc = "";
      for (const entry of videoMap) {
        if (currentTargetIndex !== null && currentTargetIndex >= entry.range[0] && currentTargetIndex <= entry.range[1]) {
          videoSrc = entry.src;
          break;
        }
      }
      if (videoSrc) {
        document.getElementById("video-source").src = videoSrc;
        document.getElementById("ar-video").load();
        document.getElementById("video-container").style.display = "block";
        document.getElementById("ar-video").play();
      }
      hideText();
      hideModel();
      hideQuestion();
    }

    function closeVideo() {
      document.getElementById("video-container").style.display = "none";
      document.getElementById("ar-video").pause();
      document.getElementById("ar-video").currentTime = 0;
    }

  //Funciones para mostrar y ocultar texto
    function showText() {
    if (currentEntity && currentEntity.textAR) {
    currentEntity.textAR.setAttribute("visible", "true");
    }
    if (currentEntity && currentEntity.modelAR) {
    currentEntity.modelAR.setAttribute("visible", "false");
    }
    closeVideo();
    hideModel();
    hideQuestion();

  }

  function hideText() {
    if (currentEntity && currentEntity.textAR) {
    currentEntity.textAR.setAttribute("visible", "false");
    }
  }

  //Funciones para mostrar y ocultar preguntas
  function showQuestion(){
    hideModel();
    closeVideo();
    hideText();

    let question = "";
    let options= [];
    let correctOption = "";

    if(currentTargetIndex >=0 && currentTargetIndex <=5){
      question = "How many World Cups has Argentina won?";
      options = ["2", "3", "4", "5"];
      correctOption = "3";
    }

    document.getElementById("question-text").innerText = question;
    document.getElementById("question-feedback").innerText = "";

    // Genera los botones de opción
    let html = "";
    options.forEach(opt => {
      html += `<button onclick="submitOption('${opt}', '${correctOption}')">${opt}</button> `;
      });
    document.getElementById("question-options").innerHTML = html;

    document.getElementById("question-container").style.display = "block";

  }

  function submitOption(selected, correct) {
    if (selected === correct) {
     document.getElementById("question-feedback").innerText = "¡Perfect!";
    } else {
     document.getElementById("question-feedback").innerText = "Wrong";
    }
  }

 function hideQuestion() {
  document.getElementById("question-container").style.display = "none";
  }
  
  </script>

</body>
</html>
